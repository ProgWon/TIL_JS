# DOM

## HTML 요소
HTML 문서를 구성하는 개별적인 요소. 렌더링 엔진에 의해서 파싱되어 DOM 을 구성하는 요소 노드 객체로 변환. 텍스트 컨텐츠는 텍스트 노드, 어트리뷰트는 어트리뷰트 노드로 변환

HTML 요소 간에는 중첩 관계에 의해 계층적인 부자 관계가 형성됨. 부자 관계를 반영해 HTML 요소를 객체화한 모든 노드 객체들을 트리 자료구조로 구성함 -> DOM 트리

## 노드 객체의 종류

1. 문서 노드 : DOM 트리의 최상위에 존재하는 루트 노드 -> document 객체 -> 브라우저가 렌더링한 HTML 문서 전체를 가리킴. window 의 document 프로퍼티에 바인딩되어 있음. HTML 당 document 객체는 유일함. DOM 트리의 루트 노드 -> DOM 트리의 노드에 접근하려면 거쳐야 할 진입점.

2. 요소 노드
HTML 요소를 가리키는 객체. 요소 노드는 HTML 요소 간의 중첩을 통해 부자 관계를 가짐. 부자 관계를 통해 정보를 구조화함

3. 어트리뷰트 노드
HTML 요소의 어트리뷰트를 가리키는 객체. HTML 요소의 요소 노드와 연결되어 있음. 어트리뷰트는 부모 노드가 없으므로 형제 노드가 아님. 어트리뷰트 노드에 접근하려면 요소 노드에 먼저 접근해야함.

4. 텍스트 노드
HTML 요소의 텍스트를 가리키는 객체. 텍스트 노드는 문서의 정보를 표현. 자식 노드를 가질 수 없는 리프 노드임. DOM 트리의 최종단이므로 부모 노드인 요소노드에 먼저 접근해야함.

## DOM API
DOM 은 HTML 문서의 계층적 구조와 정보를 표현하며 제어할 수 있는 DOM API 를 제공한다.

## 요소 노드 취득
HTML 구조나 내용 또는 스타일 등을 동적으로 변경하려면 요소 노드를 취득해야함. 텍스트 노드, 어트리뷰트 노드는 요소 노드와 연결되어 있음.

id 를 취득할때는 getElementById 사용, 이후의 나머지는 querySelector 를 사용하는 것이 좋음

## HTMLCollection/NodeList

둘다 유사 배열 객체이면서 이터러블임. 
안전하게 사용하려면 둘 다 배열로 변환해서 사용하는 것을 권장함.

### HTMLCollection
노드 객체의 상태 변화를 실시간으로 반영하는 살아 있는 DOM 컬렉션 객체. 

### NodeList
non-live 객체이지만 childNode 프로퍼티가 반환하는 NodeList 객체는 live 객체로 동작함

## 공백 텍스트 노드
HTML 요소 사이의 스페이스, 탭, 줄바꿈, 공백은 텍스트 노드를 생성함. 이를 공백 텍스트 노드라고 함.

## nodeValue
텍스트 노드가 아닌 노드의 nodeValue 는 null 을 반환한다.

텍스트를 변경할 요소 노드를 취득하고 취득한 요소 노드의 텍스트 노드를 탐색한다. 텍스트 노드의 nodeValue 프로퍼티를 사용해 텍스트 노드의 값을 변경한다.


## textContent
요소 노드의 text 와 자손 노드의 text 를 모두 반환한다. 이때 마크업은 무시된다. 만약 textContent 프로퍼티에 문자열을 할당하면 모든 자식 노드가 제거되고 할당한 문자열이 텍스트로 추가된다. -> HTML 마크업 파싱 불가능

## DOM 조작
DOM 조작은 새로운 노드를 생성해 DOM 에 추가하거나 기존 노드를 삭제, 교체하는 것을 말한다. 이는 리플로루 리페인트의 원인이 되므로 성능에 영향을 주니 조심해야 한다.

## innerHTML
요소 노드의 HTML 마크업을 취득하거나 변경한다. 문자열을 할당하면 요소 노드의 모든 자식 노드가 제거되고 할당한 문자열에 포함되어 있는 HTML 마크업이 파싱되어 요소 노드의 자식 노드로 DOM 에 반영된다.

사용자에게 입력 받은 데이터를 그대로 innerHTML 프로퍼티에 할당 하는 것은 XSS 에 취약하다. 악성 코드가 포함되어 있다면 파싱 과정에서 그대로 실행될 수 있다.

innerHTMl 프로퍼티에 HTML 마크업 문자를 할당하면 유지되어도 되는 기존의 자식 노드까지 모두 제거하고 다시 처음부터 새롭게 자식 노드를 생성해서 DOM 에 반영한다. 또한 삽입될 위치를 지정할 수 없다.

## inserAdjacentHTML

기존 요소를 제거하지 않으며 위치도 지정해서 새로운 요소 삽입이 가능하다.

## 노드 생성 추가
document.createElement 를 통해 요소 노드의 생성이 가능하다.

## 복수 노드 추가
DocumentFragment 노드를 통해서 부모 노드가 없어 기존 DOM 과는 별도로 존재한다. DOM 에 출가하면 자신은 제거되고 자식 노드만 추가된다는 장점이 있다.

## DOM 에 노드 추가하기
appendChild 메서드를 통해서 마지막 자식 노드로 추가가 가능하다.
insertBefore 메서드는 첫 번째 인수로 전달 받은 노드를 두 번째 인수로 전달 받은 노드 앞에 삽입한다. 이때 inserBefore 를 호출한 노드의 자식 노드여야 한다.

만약 이미 존재하는 노드에 사용하면 노드를 제거하고 추가함.

## 노드 복사
cloneNode 메서드는 노드의 사본을 생성해서 반환함. true 를 인수로 주면 깊은 복사하여 자손 노드가 포함된 사본을 생성함.

